<script type="module">
  // Import Firebase
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, set, push, remove, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  // PASTE YOUR CONFIG HERE
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    databaseURL: "https://YOUR_PROJECT.firebaseio.com",
    projectId: "YOUR_PROJECT",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "123...",
    appId: "1:..."
  };

  // Initialize
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // --- 1. Announcement Logic ---
  window.saveAnnouncement = function() {
      const text = document.getElementById('announcementInput').value;
      // Save to Firebase at path '/announcement'
      set(ref(db, 'announcement'), {
          text: text,
          show: !!text // true if text exists
      }).then(() => showMsg());
  };

  // --- 2. Hadith Logic ---
  window.addHadith = function() {
      const text = document.getElementById('hadithText').value;
      const source = document.getElementById('hadithSource').value;
      
      // Push new item to '/hadiths' list
      const newRef = push(ref(db, 'hadiths'));
      set(newRef, { text, source }).then(() => {
          document.getElementById('hadithText').value = '';
          document.getElementById('hadithSource').value = '';
          showMsg();
      });
  };

  // Listen for changes to display list in Admin
  onValue(ref(db, 'hadiths'), (snapshot) => {
      const list = document.getElementById('hadithList');
      list.innerHTML = '';
      snapshot.forEach((child) => {
          const key = child.key;
          const val = child.val();
          list.innerHTML += `
            <div class="list-item">
                <div><strong>${val.source}:</strong> ${val.text.substring(0,30)}...</div>
                <button class="danger" onclick="deleteItem('hadiths/${key}')">Delete</button>
            </div>`;
      });
  });

  // --- 3. Dua Logic ---
  window.addDua = function() {
      const t = document.getElementById('duaTitle').value;
      const a = document.getElementById('duaArabic').value;
      const m = document.getElementById('duaTrans').value;
      
      const newRef = push(ref(db, 'duas'));
      set(newRef, { t, a, m }).then(() => showMsg());
  };

  // --- Helpers ---
  window.deleteItem = function(path) {
      remove(ref(db, path));
  }

  function showMsg() {
      const msg = document.getElementById('msg');
      msg.style.display = 'block';
      setTimeout(() => msg.style.display = 'none', 2000);
  }
</script>
